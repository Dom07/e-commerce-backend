function cov_1ftf3f6eht(){var path="D:\\Projects\\ExpressJs\\e-commerce-backend\\helpers\\shoppingCart.js";var hash="04ebbeca7acdc6e1170a93d95ca5a719318da67b";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"D:\\Projects\\ExpressJs\\e-commerce-backend\\helpers\\shoppingCart.js",statementMap:{"0":{start:{line:1,column:11},end:{line:1,column:31}},"1":{start:{line:3,column:0},end:{line:19,column:1}},"2":{start:{line:4,column:4},end:{line:18,column:42}},"3":{start:{line:16,column:12},end:{line:16,column:49}},"4":{start:{line:18,column:24},end:{line:18,column:41}},"5":{start:{line:21,column:0},end:{line:42,column:1}},"6":{start:{line:22,column:4},end:{line:41,column:10}},"7":{start:{line:24,column:12},end:{line:24,column:33}},"8":{start:{line:25,column:12},end:{line:40,column:18}},"9":{start:{line:27,column:20},end:{line:27,column:100}},"10":{start:{line:27,column:61},end:{line:27,column:98}},"11":{start:{line:28,column:20},end:{line:28,column:72}},"12":{start:{line:29,column:20},end:{line:29,column:66}},"13":{start:{line:30,column:20},end:{line:35,column:26}},"14":{start:{line:31,column:38},end:{line:31,column:67}},"15":{start:{line:33,column:28},end:{line:33,column:74}},"16":{start:{line:34,column:28},end:{line:34,column:46}},"17":{start:{line:38,column:20},end:{line:38,column:66}},"18":{start:{line:39,column:20},end:{line:39,column:38}},"19":{start:{line:44,column:0},end:{line:58,column:1}},"20":{start:{line:45,column:4},end:{line:57,column:10}},"21":{start:{line:47,column:12},end:{line:56,column:18}},"22":{start:{line:49,column:34},end:{line:51,column:22}},"23":{start:{line:50,column:24},end:{line:50,column:67}},"24":{start:{line:52,column:20},end:{line:52,column:64}},"25":{start:{line:52,column:34},end:{line:52,column:64}},"26":{start:{line:53,column:20},end:{line:55,column:56}},"27":{start:{line:54,column:38},end:{line:54,column:74}},"28":{start:{line:55,column:40},end:{line:55,column:55}},"29":{start:{line:60,column:0},end:{line:77,column:1}},"30":{start:{line:61,column:4},end:{line:76,column:10}},"31":{start:{line:63,column:12},end:{line:75,column:18}},"32":{start:{line:65,column:20},end:{line:69,column:21}},"33":{start:{line:70,column:20},end:{line:70,column:55}},"34":{start:{line:71,column:20},end:{line:74,column:69}},"35":{start:{line:72,column:24},end:{line:72,column:53}},"36":{start:{line:74,column:40},end:{line:74,column:68}},"37":{start:{line:79,column:0},end:{line:87,column:1}},"38":{start:{line:80,column:4},end:{line:86,column:6}},"39":{start:{line:82,column:8},end:{line:82,column:26}},"40":{start:{line:83,column:8},end:{line:85,column:30}},"41":{start:{line:84,column:22},end:{line:84,column:26}},"42":{start:{line:85,column:24},end:{line:85,column:29}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:3,column:19},end:{line:3,column:20}},loc:{start:{line:3,column:33},end:{line:19,column:1}},line:3},"1":{name:"(anonymous_1)",decl:{start:{line:15,column:14},end:{line:15,column:15}},loc:{start:{line:15,column:30},end:{line:17,column:9}},line:15},"2":{name:"(anonymous_2)",decl:{start:{line:18,column:15},end:{line:18,column:16}},loc:{start:{line:18,column:24},end:{line:18,column:41}},line:18},"3":{name:"(anonymous_3)",decl:{start:{line:21,column:21},end:{line:21,column:22}},loc:{start:{line:21,column:35},end:{line:42,column:1}},line:21},"4":{name:"(anonymous_4)",decl:{start:{line:23,column:14},end:{line:23,column:15}},loc:{start:{line:23,column:26},end:{line:41,column:9}},line:23},"5":{name:"(anonymous_5)",decl:{start:{line:26,column:22},end:{line:26,column:23}},loc:{start:{line:26,column:30},end:{line:36,column:17}},line:26},"6":{name:"(anonymous_6)",decl:{start:{line:27,column:52},end:{line:27,column:53}},loc:{start:{line:27,column:61},end:{line:27,column:98}},line:27},"7":{name:"(anonymous_7)",decl:{start:{line:31,column:30},end:{line:31,column:31}},loc:{start:{line:31,column:38},end:{line:31,column:67}},line:31},"8":{name:"(anonymous_8)",decl:{start:{line:32,column:31},end:{line:32,column:32}},loc:{start:{line:32,column:40},end:{line:35,column:25}},line:32},"9":{name:"(anonymous_9)",decl:{start:{line:37,column:23},end:{line:37,column:24}},loc:{start:{line:37,column:32},end:{line:40,column:17}},line:37},"10":{name:"(anonymous_10)",decl:{start:{line:44,column:29},end:{line:44,column:30}},loc:{start:{line:44,column:43},end:{line:58,column:1}},line:44},"11":{name:"(anonymous_11)",decl:{start:{line:46,column:14},end:{line:46,column:15}},loc:{start:{line:46,column:26},end:{line:57,column:9}},line:46},"12":{name:"(anonymous_12)",decl:{start:{line:48,column:22},end:{line:48,column:23}},loc:{start:{line:48,column:30},end:{line:56,column:17}},line:48},"13":{name:"(anonymous_13)",decl:{start:{line:49,column:58},end:{line:49,column:59}},loc:{start:{line:49,column:66},end:{line:51,column:21}},line:49},"14":{name:"(anonymous_14)",decl:{start:{line:54,column:30},end:{line:54,column:31}},loc:{start:{line:54,column:38},end:{line:54,column:74}},line:54},"15":{name:"(anonymous_15)",decl:{start:{line:55,column:31},end:{line:55,column:32}},loc:{start:{line:55,column:40},end:{line:55,column:55}},line:55},"16":{name:"(anonymous_16)",decl:{start:{line:60,column:20},end:{line:60,column:21}},loc:{start:{line:60,column:34},end:{line:77,column:1}},line:60},"17":{name:"(anonymous_17)",decl:{start:{line:62,column:14},end:{line:62,column:15}},loc:{start:{line:62,column:26},end:{line:76,column:9}},line:62},"18":{name:"(anonymous_18)",decl:{start:{line:64,column:22},end:{line:64,column:23}},loc:{start:{line:64,column:38},end:{line:75,column:17}},line:64},"19":{name:"(anonymous_19)",decl:{start:{line:71,column:45},end:{line:71,column:46}},loc:{start:{line:71,column:53},end:{line:73,column:21}},line:71},"20":{name:"(anonymous_20)",decl:{start:{line:74,column:31},end:{line:74,column:32}},loc:{start:{line:74,column:40},end:{line:74,column:68}},line:74},"21":{name:"(anonymous_21)",decl:{start:{line:79,column:20},end:{line:79,column:21}},loc:{start:{line:79,column:31},end:{line:87,column:1}},line:79},"22":{name:"(anonymous_22)",decl:{start:{line:81,column:10},end:{line:81,column:11}},loc:{start:{line:81,column:18},end:{line:86,column:5}},line:81},"23":{name:"(anonymous_23)",decl:{start:{line:84,column:14},end:{line:84,column:15}},loc:{start:{line:84,column:22},end:{line:84,column:26}},line:84},"24":{name:"(anonymous_24)",decl:{start:{line:85,column:15},end:{line:85,column:16}},loc:{start:{line:85,column:24},end:{line:85,column:29}},line:85}},branchMap:{"0":{loc:{start:{line:52,column:20},end:{line:52,column:64}},type:"if",locations:[{start:{line:52,column:20},end:{line:52,column:64}},{start:{line:52,column:20},end:{line:52,column:64}}],line:52}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0},b:{"0":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"04ebbeca7acdc6e1170a93d95ca5a719318da67b"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_1ftf3f6eht=function(){return actualCoverage;};return actualCoverage;}cov_1ftf3f6eht();const db=(cov_1ftf3f6eht().s[0]++,require('../models'));cov_1ftf3f6eht().s[1]++;exports.viewCart=(req,res)=>{cov_1ftf3f6eht().f[0]++;cov_1ftf3f6eht().s[2]++;db.Customer.findOne({_id:req.params.customer_id},'shoppingCart').populate([{path:"shoppingCart",model:"ShoppingCart",populate:{path:"products.productId",select:"image price name quantity"}}]).then(shoppingCart=>{cov_1ftf3f6eht().f[1]++;cov_1ftf3f6eht().s[3]++;res.send({"SUCCESS":shoppingCart});}).catch(error=>{cov_1ftf3f6eht().f[2]++;cov_1ftf3f6eht().s[4]++;return res.send("ERROR");});};cov_1ftf3f6eht().s[5]++;exports.updateCart=(req,res)=>{cov_1ftf3f6eht().f[3]++;cov_1ftf3f6eht().s[6]++;db.Customer.findOne({_id:req.body.customer_id},'shoppingCart').populate('shoppingCart').then(customer=>{cov_1ftf3f6eht().f[4]++;cov_1ftf3f6eht().s[7]++;console.log(customer);cov_1ftf3f6eht().s[8]++;db.ShoppingCart.findOne({_id:customer.shoppingCart}).then(cart=>{cov_1ftf3f6eht().f[5]++;cov_1ftf3f6eht().s[9]++;index=cart.products.findIndex(item=>{cov_1ftf3f6eht().f[6]++;cov_1ftf3f6eht().s[10]++;return item.productId==req.body.product_id;});cov_1ftf3f6eht().s[11]++;cart.products[index]["quantity"]=req.body.quantity;cov_1ftf3f6eht().s[12]++;cart.products[index]["dateAdded"]=new Date();cov_1ftf3f6eht().s[13]++;cart.save().then(cart=>{cov_1ftf3f6eht().f[7]++;cov_1ftf3f6eht().s[14]++;return res.send({"SUCCESS":cart});}).catch(error=>{cov_1ftf3f6eht().f[8]++;cov_1ftf3f6eht().s[15]++;res.send({"ERROR":"Failed to update cart"});cov_1ftf3f6eht().s[16]++;console.log(error);});}).catch(error=>{cov_1ftf3f6eht().f[9]++;cov_1ftf3f6eht().s[17]++;res.send({"ERROR":"Failed to update cart"});cov_1ftf3f6eht().s[18]++;console.log(error);});});};cov_1ftf3f6eht().s[19]++;exports.removeItemFromCart=(req,res)=>{cov_1ftf3f6eht().f[10]++;cov_1ftf3f6eht().s[20]++;db.Customer.findOne({_id:req.body.customer_id},'shoppingCart').then(response=>{cov_1ftf3f6eht().f[11]++;cov_1ftf3f6eht().s[21]++;db.ShoppingCart.findOne({_id:response.shoppingCart}).then(cart=>{cov_1ftf3f6eht().f[12]++;const index=(cov_1ftf3f6eht().s[22]++,cart.products.findIndex(item=>{cov_1ftf3f6eht().f[13]++;cov_1ftf3f6eht().s[23]++;return item.productId==req.body.productId;}));cov_1ftf3f6eht().s[24]++;if(index!=-1){cov_1ftf3f6eht().b[0][0]++;cov_1ftf3f6eht().s[25]++;cart.products.splice(index,1);}else{cov_1ftf3f6eht().b[0][1]++;}cov_1ftf3f6eht().s[26]++;cart.save().then(cart=>{cov_1ftf3f6eht().f[14]++;cov_1ftf3f6eht().s[27]++;return res.send({"SUCCESS":cart.products});}).catch(error=>{cov_1ftf3f6eht().f[15]++;cov_1ftf3f6eht().s[28]++;return res.send(error);});});});};cov_1ftf3f6eht().s[29]++;exports.addToCart=(req,res)=>{cov_1ftf3f6eht().f[16]++;cov_1ftf3f6eht().s[30]++;db.Customer.findOne({_id:req.body.customer_id},'shoppingCart').then(customer=>{cov_1ftf3f6eht().f[17]++;cov_1ftf3f6eht().s[31]++;db.ShoppingCart.findOne({_id:customer.shoppingCart}).then(shoppingCart=>{cov_1ftf3f6eht().f[18]++;cov_1ftf3f6eht().s[32]++;product={productId:req.body.product_id,quantity:1,dateAdded:new Date()};cov_1ftf3f6eht().s[33]++;shoppingCart.products.push(product);cov_1ftf3f6eht().s[34]++;shoppingCart.save().then(cart=>{cov_1ftf3f6eht().f[19]++;cov_1ftf3f6eht().s[35]++;res.send({"SUCCESS":cart});}).catch(error=>{cov_1ftf3f6eht().f[20]++;cov_1ftf3f6eht().s[36]++;return res.send({"ERROR":error});});});});};cov_1ftf3f6eht().s[37]++;exports.clearCart=cartId=>{cov_1ftf3f6eht().f[21]++;cov_1ftf3f6eht().s[38]++;db.ShoppingCart.findOne({_id:cartId}).then(cart=>{cov_1ftf3f6eht().f[22]++;cov_1ftf3f6eht().s[39]++;cart.products=[];cov_1ftf3f6eht().s[40]++;cart.save().then(cart=>{cov_1ftf3f6eht().f[23]++;cov_1ftf3f6eht().s[41]++;return true;}).catch(error=>{cov_1ftf3f6eht().f[24]++;cov_1ftf3f6eht().s[42]++;return error;});});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNob3BwaW5nQ2FydC5qcyJdLCJuYW1lcyI6WyJkYiIsInJlcXVpcmUiLCJleHBvcnRzIiwidmlld0NhcnQiLCJyZXEiLCJyZXMiLCJDdXN0b21lciIsImZpbmRPbmUiLCJfaWQiLCJwYXJhbXMiLCJjdXN0b21lcl9pZCIsInBvcHVsYXRlIiwicGF0aCIsIm1vZGVsIiwic2VsZWN0IiwidGhlbiIsInNob3BwaW5nQ2FydCIsInNlbmQiLCJjYXRjaCIsImVycm9yIiwidXBkYXRlQ2FydCIsImJvZHkiLCJjdXN0b21lciIsImNvbnNvbGUiLCJsb2ciLCJTaG9wcGluZ0NhcnQiLCJjYXJ0IiwiaW5kZXgiLCJwcm9kdWN0cyIsImZpbmRJbmRleCIsIml0ZW0iLCJwcm9kdWN0SWQiLCJwcm9kdWN0X2lkIiwicXVhbnRpdHkiLCJEYXRlIiwic2F2ZSIsInJlbW92ZUl0ZW1Gcm9tQ2FydCIsInJlc3BvbnNlIiwic3BsaWNlIiwiYWRkVG9DYXJ0IiwicHJvZHVjdCIsImRhdGVBZGRlZCIsInB1c2giLCJjbGVhckNhcnQiLCJjYXJ0SWQiXSwibWFwcGluZ3MiOiIyMU9BQUEsS0FBTUEsQ0FBQUEsRUFBRSwwQkFBR0MsT0FBTyxDQUFDLFdBQUQsQ0FBVixDQUFSLEMsd0JBRUFDLE9BQU8sQ0FBQ0MsUUFBUixDQUFtQixDQUFDQyxHQUFELENBQU1DLEdBQU4sR0FBYyxpREFDN0JMLEVBQUUsQ0FBQ00sUUFBSCxDQUFZQyxPQUFaLENBQW9CLENBQUVDLEdBQUcsQ0FBRUosR0FBRyxDQUFDSyxNQUFKLENBQVdDLFdBQWxCLENBQXBCLENBQXFELGNBQXJELEVBQ0tDLFFBREwsQ0FDYyxDQUNOLENBQ0lDLElBQUksQ0FBRSxjQURWLENBRUlDLEtBQUssQ0FBRSxjQUZYLENBR0lGLFFBQVEsQ0FBRSxDQUNOQyxJQUFJLENBQUUsb0JBREEsQ0FFTkUsTUFBTSxDQUFFLDJCQUZGLENBSGQsQ0FETSxDQURkLEVBV0tDLElBWEwsQ0FXVUMsWUFBWSxFQUFJLGlEQUNsQlgsR0FBRyxD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SSx5REFBQWQsQ0FBQUEsR0FBRyxDQUFDWSxJQUFKLENBQVMsQ0FBRSxRQUFTRSxLQUFYLENBQVQsRUFBNEIsQ0FIaEQsRUFJSCxDQVpMLEVBYUgsQ0FmTCxFQWdCSCxDQWpCRCxDLHlCQW1CQWpCLE9BQU8sQ0FBQ3lDLFNBQVIsQ0FBcUJDLE1BQUQsRUFBVyxtREFDM0I1QyxFQUFFLENBQUN5QixZQUFILENBQWdCbEIsT0FBaEIsQ0FBd0IsQ0FBQ0MsR0FBRyxDQUFFb0MsTUFBTixDQUF4QixFQUNDN0IsSUFERCxDQUNNVyxJQUFJLEVBQUksbURBQ1ZBLElBQUksQ0FBQ0UsUUFBTCxDQUFnQixFQUFoQixDQURVLHlCQUVWRixJQUFJLENBQUNTLElBQUwsR0FDQ3BCLElBREQsQ0FDTVcsSUFBSSxFQUFJLCtEQUFJLENBRGxCLEVBRUNSLEtBRkQsQ0FFT0MsS0FBSyxFQUFJQSx5REFBQUEsQ0FBQUEsS0FBSyxFQUZyQixFQUdILENBTkQsRUFPSCxDQVJEIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZGIgPSByZXF1aXJlKCcuLi9tb2RlbHMnKVxyXG5cclxuZXhwb3J0cy52aWV3Q2FydCA9IChyZXEsIHJlcykgPT4ge1xyXG4gICAgZGIuQ3VzdG9tZXIuZmluZE9uZSh7IF9pZDogcmVxLnBhcmFtcy5jdXN0b21lcl9pZCB9LCAnc2hvcHBpbmdDYXJ0JylcclxuICAgICAgICAucG9wdWxhdGUoW1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBcInNob3BwaW5nQ2FydFwiLFxyXG4gICAgICAgICAgICAgICAgbW9kZWw6IFwiU2hvcHBpbmdDYXJ0XCIsXHJcbiAgICAgICAgICAgICAgICBwb3B1bGF0ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhdGg6IFwicHJvZHVjdHMucHJvZHVjdElkXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0OiBcImltYWdlIHByaWNlIG5hbWUgcXVhbnRpdHlcIlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXSlcclxuICAgICAgICAudGhlbihzaG9wcGluZ0NhcnQgPT4ge1xyXG4gICAgICAgICAgICByZXMuc2VuZCh7IFwiU1VDQ0VTU1wiOiBzaG9wcGluZ0NhcnQgfSlcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChlcnJvciA9PiByZXMuc2VuZChcIkVSUk9SXCIpKVxyXG59XHJcblxyXG5leHBvcnRzLnVwZGF0ZUNhcnQgPSAocmVxLCByZXMpID0+IHtcclxuICAgIGRiLkN1c3RvbWVyLmZpbmRPbmUoeyBfaWQ6IHJlcS5ib2R5LmN1c3RvbWVyX2lkIH0sICdzaG9wcGluZ0NhcnQnKS5wb3B1bGF0ZSgnc2hvcHBpbmdDYXJ0JylcclxuICAgICAgICAudGhlbihjdXN0b21lciA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGN1c3RvbWVyKVxyXG4gICAgICAgICAgICBkYi5TaG9wcGluZ0NhcnQuZmluZE9uZSh7IF9pZDogY3VzdG9tZXIuc2hvcHBpbmdDYXJ0IH0pXHJcbiAgICAgICAgICAgICAgICAudGhlbihjYXJ0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpbmRleCA9IGNhcnQucHJvZHVjdHMuZmluZEluZGV4KGl0ZW0gPT4gKGl0ZW0ucHJvZHVjdElkID09IHJlcS5ib2R5LnByb2R1Y3RfaWQpKVxyXG4gICAgICAgICAgICAgICAgICAgIGNhcnQucHJvZHVjdHNbaW5kZXhdW1wicXVhbnRpdHlcIl0gPSByZXEuYm9keS5xdWFudGl0eVxyXG4gICAgICAgICAgICAgICAgICAgIGNhcnQucHJvZHVjdHNbaW5kZXhdW1wiZGF0ZUFkZGVkXCJdID0gbmV3IERhdGUoKVxyXG4gICAgICAgICAgICAgICAgICAgIGNhcnQuc2F2ZSgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGNhcnQgPT4gcmVzLnNlbmQoeyBcIlNVQ0NFU1NcIjogY2FydCB9KSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5zZW5kKHsgXCJFUlJPUlwiOiBcIkZhaWxlZCB0byB1cGRhdGUgY2FydFwiIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcilcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcy5zZW5kKHsgXCJFUlJPUlwiOiBcIkZhaWxlZCB0byB1cGRhdGUgY2FydFwiIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXHJcbn1cclxuXHJcbmV4cG9ydHMucmVtb3ZlSXRlbUZyb21DYXJ0ID0gKHJlcSwgcmVzKSA9PiB7XHJcbiAgICBkYi5DdXN0b21lci5maW5kT25lKHsgX2lkOiByZXEuYm9keS5jdXN0b21lcl9pZCB9LCAnc2hvcHBpbmdDYXJ0JylcclxuICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7XHJcbiAgICAgICAgICAgIGRiLlNob3BwaW5nQ2FydC5maW5kT25lKHsgX2lkOiByZXNwb25zZS5zaG9wcGluZ0NhcnQgfSlcclxuICAgICAgICAgICAgICAgIC50aGVuKGNhcnQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gY2FydC5wcm9kdWN0cy5maW5kSW5kZXgoaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLnByb2R1Y3RJZCA9PSByZXEuYm9keS5wcm9kdWN0SWRcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIGlmKGluZGV4IT0tMSkgY2FydC5wcm9kdWN0cy5zcGxpY2UoaW5kZXgsIDEpXHJcbiAgICAgICAgICAgICAgICAgICAgY2FydC5zYXZlKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oY2FydCA9PiByZXMuc2VuZCh7XCJTVUNDRVNTXCI6IGNhcnQucHJvZHVjdHN9KSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IHJlcy5zZW5kKGVycm9yKSlcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxufVxyXG5cclxuZXhwb3J0cy5hZGRUb0NhcnQgPSAocmVxLCByZXMpID0+IHtcclxuICAgIGRiLkN1c3RvbWVyLmZpbmRPbmUoeyBfaWQ6IHJlcS5ib2R5LmN1c3RvbWVyX2lkIH0sICdzaG9wcGluZ0NhcnQnKVxyXG4gICAgICAgIC50aGVuKGN1c3RvbWVyID0+IHtcclxuICAgICAgICAgICAgZGIuU2hvcHBpbmdDYXJ0LmZpbmRPbmUoeyBfaWQ6IGN1c3RvbWVyLnNob3BwaW5nQ2FydCB9KVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oc2hvcHBpbmdDYXJ0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0ID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHJlcS5ib2R5LnByb2R1Y3RfaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1YW50aXR5OiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlQWRkZWQ6IG5ldyBEYXRlKClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgc2hvcHBpbmdDYXJ0LnByb2R1Y3RzLnB1c2gocHJvZHVjdClcclxuICAgICAgICAgICAgICAgICAgICBzaG9wcGluZ0NhcnQuc2F2ZSgpLnRoZW4oY2FydCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5zZW5kKHsgXCJTVUNDRVNTXCI6IGNhcnQgfSlcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4gcmVzLnNlbmQoeyBcIkVSUk9SXCI6IGVycm9yIH0pKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG59XHJcblxyXG5leHBvcnRzLmNsZWFyQ2FydCA9IChjYXJ0SWQpID0+e1xyXG4gICAgZGIuU2hvcHBpbmdDYXJ0LmZpbmRPbmUoe19pZDogY2FydElkfSlcclxuICAgIC50aGVuKGNhcnQgPT4ge1xyXG4gICAgICAgIGNhcnQucHJvZHVjdHMgPSBbXVxyXG4gICAgICAgIGNhcnQuc2F2ZSgpXHJcbiAgICAgICAgLnRoZW4oY2FydCA9PiB0cnVlKVxyXG4gICAgICAgIC5jYXRjaChlcnJvciA9PiBlcnJvcilcclxuICAgIH0pXHJcbn0iXX0=
function cov_2orxwxlbcg(){var path="D:\\Projects\\ExpressJs\\e-commerce-backend\\helpers\\order.js";var hash="c8eff555415d46b93a9fd818cd17b50586b594e5";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"D:\\Projects\\ExpressJs\\e-commerce-backend\\helpers\\order.js",statementMap:{"0":{start:{line:1,column:9},end:{line:1,column:29}},"1":{start:{line:2,column:22},end:{line:2,column:51}},"2":{start:{line:3,column:16},end:{line:3,column:50}},"3":{start:{line:5,column:0},end:{line:62,column:1}},"4":{start:{line:6,column:4},end:{line:61,column:10}},"5":{start:{line:20,column:28},end:{line:20,column:30}},"6":{start:{line:21,column:12},end:{line:37,column:14}},"7":{start:{line:22,column:16},end:{line:36,column:22}},"8":{start:{line:26,column:24},end:{line:35,column:25}},"9":{start:{line:27,column:28},end:{line:32,column:111}},"10":{start:{line:31,column:44},end:{line:31,column:48}},"11":{start:{line:32,column:48},end:{line:32,column:110}},"12":{start:{line:34,column:28},end:{line:34,column:79}},"13":{start:{line:38,column:12},end:{line:38,column:54}},"14":{start:{line:39,column:12},end:{line:56,column:97}},"15":{start:{line:43,column:20},end:{line:53,column:21}},"16":{start:{line:44,column:24},end:{line:47,column:26}},"17":{start:{line:49,column:24},end:{line:52,column:26}},"18":{start:{line:56,column:32},end:{line:56,column:96}},"19":{start:{line:59,column:12},end:{line:59,column:30}},"20":{start:{line:60,column:12},end:{line:60,column:40}},"21":{start:{line:64,column:0},end:{line:80,column:1}},"22":{start:{line:65,column:4},end:{line:79,column:10}},"23":{start:{line:75,column:12},end:{line:75,column:42}},"24":{start:{line:78,column:12},end:{line:78,column:30}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:5,column:21},end:{line:5,column:22}},loc:{start:{line:5,column:35},end:{line:62,column:1}},line:5},"1":{name:"(anonymous_1)",decl:{start:{line:19,column:14},end:{line:19,column:15}},loc:{start:{line:19,column:23},end:{line:57,column:9}},line:19},"2":{name:"(anonymous_2)",decl:{start:{line:21,column:38},end:{line:21,column:39}},loc:{start:{line:21,column:46},end:{line:37,column:13}},line:21},"3":{name:"(anonymous_3)",decl:{start:{line:25,column:20},end:{line:25,column:21}},loc:{start:{line:25,column:30},end:{line:36,column:21}},line:25},"4":{name:"(anonymous_4)",decl:{start:{line:31,column:38},end:{line:31,column:39}},loc:{start:{line:31,column:44},end:{line:31,column:48}},line:31},"5":{name:"(anonymous_5)",decl:{start:{line:32,column:39},end:{line:32,column:40}},loc:{start:{line:32,column:48},end:{line:32,column:110}},line:32},"6":{name:"(anonymous_6)",decl:{start:{line:42,column:22},end:{line:42,column:23}},loc:{start:{line:42,column:34},end:{line:55,column:17}},line:42},"7":{name:"(anonymous_7)",decl:{start:{line:56,column:23},end:{line:56,column:24}},loc:{start:{line:56,column:32},end:{line:56,column:96}},line:56},"8":{name:"(anonymous_8)",decl:{start:{line:58,column:15},end:{line:58,column:16}},loc:{start:{line:58,column:24},end:{line:61,column:9}},line:58},"9":{name:"(anonymous_9)",decl:{start:{line:64,column:20},end:{line:64,column:21}},loc:{start:{line:64,column:34},end:{line:80,column:1}},line:64},"10":{name:"(anonymous_10)",decl:{start:{line:74,column:14},end:{line:74,column:15}},loc:{start:{line:74,column:23},end:{line:76,column:9}},line:74},"11":{name:"(anonymous_11)",decl:{start:{line:77,column:15},end:{line:77,column:16}},loc:{start:{line:77,column:24},end:{line:79,column:9}},line:77}},branchMap:{"0":{loc:{start:{line:26,column:24},end:{line:35,column:25}},type:"if",locations:[{start:{line:26,column:24},end:{line:35,column:25}},{start:{line:26,column:24},end:{line:35,column:25}}],line:26},"1":{loc:{start:{line:43,column:20},end:{line:53,column:21}},type:"if",locations:[{start:{line:43,column:20},end:{line:53,column:21}},{start:{line:43,column:20},end:{line:53,column:21}}],line:43}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},b:{"0":[0,0],"1":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"c8eff555415d46b93a9fd818cd17b50586b594e5"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_2orxwxlbcg=function(){return actualCoverage;};return actualCoverage;}cov_2orxwxlbcg();var db=(cov_2orxwxlbcg().s[0]++,require('../models'));const productHelper=(cov_2orxwxlbcg().s[1]++,require('../helpers/product'));const helpers=(cov_2orxwxlbcg().s[2]++,require('../helpers/shoppingCart'));cov_2orxwxlbcg().s[3]++;exports.placeOrder=(req,res)=>{cov_2orxwxlbcg().f[0]++;cov_2orxwxlbcg().s[4]++;db.Order.create({orderDate:Date.now(),status:"Processing",product:[],shippingAddress:req.body.shippingAddress,totalPrice:req.body.totalPrice,paymentDetails:{cardHolderName:req.body.cardHolderName,cardNumber:req.body.cardNumber,expiryDate:req.body.expiryDate,CVV:req.body.CVV}}).then(order=>{cov_2orxwxlbcg().f[1]++;const message=(cov_2orxwxlbcg().s[5]++,[]);cov_2orxwxlbcg().s[6]++;req.body.products.forEach(item=>{cov_2orxwxlbcg().f[2]++;cov_2orxwxlbcg().s[7]++;productHelper.getProductCountAndReduce(item.quantity,item.productId._id,result=>{cov_2orxwxlbcg().f[3]++;cov_2orxwxlbcg().s[8]++;if(result){cov_2orxwxlbcg().b[0][0]++;cov_2orxwxlbcg().s[9]++;db.Order.findByIdAndUpdate(order._id,{$push:{product:item}},{safe:true,upsert:true}).then(()=>{cov_2orxwxlbcg().f[4]++;cov_2orxwxlbcg().s[10]++;return null;}).catch(error=>{cov_2orxwxlbcg().f[5]++;cov_2orxwxlbcg().s[11]++;return console.log("Error adding product to order document: ",error);});}else{cov_2orxwxlbcg().b[0][1]++;cov_2orxwxlbcg().s[12]++;message.push(item.productId._id+" is out of stock");}});});cov_2orxwxlbcg().s[13]++;helpers.clearCart(req.body.shoppingCartId);cov_2orxwxlbcg().s[14]++;db.Customer.findByIdAndUpdate(req.body.customer_id,{$push:{order:order}},{safe:true,upsert:true}).then(customer=>{cov_2orxwxlbcg().f[6]++;cov_2orxwxlbcg().s[15]++;if(message.length>0){cov_2orxwxlbcg().b[1][0]++;cov_2orxwxlbcg().s[16]++;res.send({"FAILED":"One or more items out of stock","MESSAGE":message});}else{cov_2orxwxlbcg().b[1][1]++;cov_2orxwxlbcg().s[17]++;res.send({"SUCCESS":customer,"MESSAGE":"No Error"});}}).catch(error=>{cov_2orxwxlbcg().f[7]++;cov_2orxwxlbcg().s[18]++;return console.log("ERROR while pushing to customer document: ",error);});}).catch(error=>{cov_2orxwxlbcg().f[8]++;cov_2orxwxlbcg().s[19]++;console.log(error);cov_2orxwxlbcg().s[20]++;res.send({"ERROR":error});});};cov_2orxwxlbcg().s[21]++;exports.getOrders=(req,res)=>{cov_2orxwxlbcg().f[9]++;cov_2orxwxlbcg().s[22]++;db.Customer.findOne({_id:req.params.customerId},"order").populate({path:"order",select:"orderDate status totalPrice product",populate:{path:"product.productId",select:"name image price"}}).then(order=>{cov_2orxwxlbcg().f[10]++;cov_2orxwxlbcg().s[23]++;res.send({"SUCCESS":order});}).catch(error=>{cov_2orxwxlbcg().f[11]++;cov_2orxwxlbcg().s[24]++;console.log(error);});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm9yZGVyLmpzIl0sIm5hbWVzIjpbImRiIiwicmVxdWlyZSIsInByb2R1Y3RIZWxwZXIiLCJoZWxwZXJzIiwiZXhwb3J0cyIsInBsYWNlT3JkZXIiLCJyZXEiLCJyZXMiLCJPcmRlciIsImNyZWF0ZSIsIm9yZGVyRGF0ZSIsIkRhdGUiLCJub3ciLCJzdGF0dXMiLCJwcm9kdWN0Iiwic2hpcHBpbmdBZGRyZXNzIiwiYm9keSIsInRvdGFsUHJpY2UiLCJwYXltZW50RGV0YWlscyIsImNhcmRIb2xkZXJOYW1lIiwiY2FyZE51bWJlciIsImV4cGlyeURhdGUiLCJDVlYiLCJ0aGVuIiwib3JkZXIiLCJtZXNzYWdlIiwicHJvZHVjdHMiLCJmb3JFYWNoIiwiaXRlbSIsImdldFByb2R1Y3RDb3VudEFuZFJlZHVjZSIsInF1YW50aXR5IiwicHJvZHVjdElkIiwiX2lkIiwicmVzdWx0IiwiZmluZEJ5SWRBbmRVcGRhdGUiLCIkcHVzaCIsInNhZmUiLCJ1cHNlcnQiLCJjYXRjaCIsImVycm9yIiwiY29uc29sZSIsImxvZyIsInB1c2giLCJjbGVhckNhcnQiLCJzaG9wcGluZ0NhcnRJZCIsIkN1c3RvbWVyIiwiY3VzdG9tZXJfaWQiLCJjdXN0b21lciIsImxlbmd0aCIsInNlbmQiLCJnZXRPcmRlcnMiLCJmaW5kT25lIiwicGFyYW1zIiwiY3VzdG9tZXJJZCIsInBvcHVsYXRlIiwicGF0aCIsInNlbGVjdCJdLCJtYXBwaW5ncyI6Iis2SUFBQSxHQUFJQSxDQUFBQSxFQUFFLDBCQUFHQyxPQUFPLENBQUMsV0FBRCxDQUFWLENBQU4sQ0FDQSxLQUFNQyxDQUFBQSxhQUFhLDBCQUFHRCxPQUFPLENBQUMsb0JBQUQsQ0FBVixDQUFuQixDQUNBLEtBQU1FLENBQUFBLE9BQU8sMEJBQUdGLE9BQU8sQ0FBQyx5QkFBRCxDQUFWLENBQWIsQyx3QkFFQUcsT0FBTyxDQUFDQyxVQUFSLENBQXFCLENBQUNDLEdBQUQsQ0FBTUMsR0FBTixHQUFjLGlEQUMvQlAsRUFBRSxDQUFDUSxLQUFI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eUJBMkRBbkMsT0FBTyxDQUFDOEMsU0FBUixDQUFvQixDQUFDNUMsR0FBRCxDQUFNQyxHQUFOLEdBQWMsa0RBQzlCUCxFQUFFLENBQUM2QyxRQUFILENBQVlNLE9BQVosQ0FBb0IsQ0FBRW5CLEdBQUcsQ0FBRTFCLEdBQUcsQ0FBQzhDLE1BQUosQ0FBV0MsVUFBbEIsQ0FBcEIsQ0FBb0QsT0FBcEQsRUFDS0MsUUFETCxDQUNjLENBQ05DLElBQUksQ0FBRSxPQURBLENBRU5DLE1BQU0sQ0FBRSxxQ0FGRixDQUdORixRQUFRLENBQUUsQ0FDTkMsSUFBSSxDQUFFLG1CQURBLENBRU5DLE1BQU0sQ0FBRSxrQkFGRixDQUhKLENBRGQsRUFTS2pDLElBVEwsQ0FTVUMsS0FBSyxFQUFJLG1EQUNYakIsR0FBRyxDQUFDMEMsSUFBSixDQUFTLENBQUUsVUFBV3pCLEtBQWIsQ0FBVCxFQUNILENBWEwsRUFZS2MsS0FaTCxDQVlXQyxLQUFLLEVBQUksbURBQ1pDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZRixLQUFaLEVBQ0gsQ0FkTCxFQWVILENBaEJEIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGRiID0gcmVxdWlyZSgnLi4vbW9kZWxzJylcclxuY29uc3QgcHJvZHVjdEhlbHBlciA9IHJlcXVpcmUoJy4uL2hlbHBlcnMvcHJvZHVjdCcpXHJcbmNvbnN0IGhlbHBlcnMgPSByZXF1aXJlKCcuLi9oZWxwZXJzL3Nob3BwaW5nQ2FydCcpXHJcblxyXG5leHBvcnRzLnBsYWNlT3JkZXIgPSAocmVxLCByZXMpID0+IHtcclxuICAgIGRiLk9yZGVyLmNyZWF0ZSh7XHJcbiAgICAgICAgb3JkZXJEYXRlOiBEYXRlLm5vdygpLFxyXG4gICAgICAgIHN0YXR1czogXCJQcm9jZXNzaW5nXCIsXHJcbiAgICAgICAgcHJvZHVjdDogW10sXHJcbiAgICAgICAgc2hpcHBpbmdBZGRyZXNzOiByZXEuYm9keS5zaGlwcGluZ0FkZHJlc3MsXHJcbiAgICAgICAgdG90YWxQcmljZTogcmVxLmJvZHkudG90YWxQcmljZSxcclxuICAgICAgICBwYXltZW50RGV0YWlsczoge1xyXG4gICAgICAgICAgICBjYXJkSG9sZGVyTmFtZTogcmVxLmJvZHkuY2FyZEhvbGRlck5hbWUsXHJcbiAgICAgICAgICAgIGNhcmROdW1iZXI6IHJlcS5ib2R5LmNhcmROdW1iZXIsXHJcbiAgICAgICAgICAgIGV4cGlyeURhdGU6IHJlcS5ib2R5LmV4cGlyeURhdGUsXHJcbiAgICAgICAgICAgIENWVjogcmVxLmJvZHkuQ1ZWXHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxuICAgICAgICAudGhlbihvcmRlciA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBbXVxyXG4gICAgICAgICAgICByZXEuYm9keS5wcm9kdWN0cy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdEhlbHBlci5nZXRQcm9kdWN0Q291bnRBbmRSZWR1Y2UoXHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5xdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBpdGVtLnByb2R1Y3RJZC5faWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGIuT3JkZXIuZmluZEJ5SWRBbmRVcGRhdGUob3JkZXIuX2lkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgJHB1c2g6IHsgcHJvZHVjdDogaXRlbSB9IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBzYWZlOiB0cnVlLCB1cHNlcnQ6IHRydWUgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4gY29uc29sZS5sb2coXCJFcnJvciBhZGRpbmcgcHJvZHVjdCB0byBvcmRlciBkb2N1bWVudDogXCIsIGVycm9yKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UucHVzaChpdGVtLnByb2R1Y3RJZC5faWQrXCIgaXMgb3V0IG9mIHN0b2NrXCIpIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgaGVscGVycy5jbGVhckNhcnQocmVxLmJvZHkuc2hvcHBpbmdDYXJ0SWQpXHJcbiAgICAgICAgICAgIGRiLkN1c3RvbWVyLmZpbmRCeUlkQW5kVXBkYXRlKHJlcS5ib2R5LmN1c3RvbWVyX2lkLFxyXG4gICAgICAgICAgICAgICAgeyAkcHVzaDogeyBvcmRlcjogb3JkZXIgfSB9LFxyXG4gICAgICAgICAgICAgICAgeyBzYWZlOiB0cnVlLCB1cHNlcnQ6IHRydWUgfSlcclxuICAgICAgICAgICAgICAgIC50aGVuKGN1c3RvbWVyID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZihtZXNzYWdlLmxlbmd0aD4wKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLnNlbmQoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJGQUlMRURcIjogXCJPbmUgb3IgbW9yZSBpdGVtcyBvdXQgb2Ygc3RvY2tcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiTUVTU0FHRVwiOiBtZXNzYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5zZW5kKHsgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlNVQ0NFU1NcIjogY3VzdG9tZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIk1FU1NBR0VcIjogXCJObyBFcnJvclwiIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiBjb25zb2xlLmxvZyhcIkVSUk9SIHdoaWxlIHB1c2hpbmcgdG8gY3VzdG9tZXIgZG9jdW1lbnQ6IFwiLCBlcnJvcikpXHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcilcclxuICAgICAgICAgICAgcmVzLnNlbmQoeyBcIkVSUk9SXCI6IGVycm9yIH0pXHJcbiAgICAgICAgfSlcclxufVxyXG5cclxuZXhwb3J0cy5nZXRPcmRlcnMgPSAocmVxLCByZXMpID0+IHtcclxuICAgIGRiLkN1c3RvbWVyLmZpbmRPbmUoeyBfaWQ6IHJlcS5wYXJhbXMuY3VzdG9tZXJJZCB9LCBcIm9yZGVyXCIpXHJcbiAgICAgICAgLnBvcHVsYXRlKHtcclxuICAgICAgICAgICAgcGF0aDogXCJvcmRlclwiLFxyXG4gICAgICAgICAgICBzZWxlY3Q6IFwib3JkZXJEYXRlIHN0YXR1cyB0b3RhbFByaWNlIHByb2R1Y3RcIixcclxuICAgICAgICAgICAgcG9wdWxhdGU6IHtcclxuICAgICAgICAgICAgICAgIHBhdGg6IFwicHJvZHVjdC5wcm9kdWN0SWRcIixcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogXCJuYW1lIGltYWdlIHByaWNlXCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4ob3JkZXIgPT4ge1xyXG4gICAgICAgICAgICByZXMuc2VuZCh7IFwiU1VDQ0VTU1wiOiBvcmRlciB9KVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKGVycm9yID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpXHJcbiAgICAgICAgfSlcclxufSJdfQ==